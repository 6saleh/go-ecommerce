
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go-Commerce</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <header class="bg-dark text-white p-3">
        <div class="container d-flex justify-content-between align-items-center">
            <h1><a href="/" class="text-white text-decoration-none">Go-Commerce</a></h1>
            <nav>
                <a href="#" class="text-white text-decoration-none me-3" id="orders-button">My Orders</a>
                <a href="#" class="text-white text-decoration-none me-3" id="cart-button" @click.prevent="showCart">Cart (<span id="cart-count">{{ cartItemCount }}</span>)</a>
                <a href="#" class="btn btn-primary" id="login-button" @click.prevent="toggleLogin">{{ loggedIn ? 'Logout' : 'Login' }}</a>
            </nav>
        </div>
    </header>

    <main id="app" class="container mt-4">
        <div class="product-filters mb-4 row">
            <div class="col-md-8">
                <input type="text" id="search-bar" class="form-control" placeholder="Search for products..." v-model="searchTerm" @input="fetchProducts()">
            </div>
            <div class="col-md-4">
                <select id="category-filter" class="form-select" v-model="selectedCategory" @change="fetchProducts()">
                    <option value="">All Categories</option>
                    <option v-for="category in categories" :key="category.id" :value="category.id">{{ category.name }}</option>
                </select>
            </div>
        </div>
        <h2>Products</h2>
        <div id="product-list" class="row">
            <div class="col-md-4" v-for="product in products" :key="product.id">
                <div class="card product-card" :data-product-id="product.id" @click="showProductDetails(product.id)">
                    <img :src="product.imageUrl" class="card-img-top" :alt="product.name">
                    <div class="card-body">
                        <h5 class="card-title">{{ product.name }}</h5>
                        <p class="card-text">{{ product.description }}</p>
                        <p class="card-text"><b>${{ product.price.toFixed(2) }}</b></p>
                        <button class="btn btn-primary add-to-cart-btn" :data-product-id="product.id" @click.stop="addToCart(product.id)">Add to Cart</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="product-modal" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content" v-if="selectedProduct">
                <div class="modal-header">
                    <h5 class="modal-title" id="product-modal-title">{{ selectedProduct.name }}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="product-modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <img :src="selectedProduct.imageUrl" class="img-fluid" :alt="selectedProduct.name">
                        </div>
                        <div class="col-md-6">
                            <p>{{ selectedProduct.description }}</p>
                            <p><b>${{ selectedProduct.price.toFixed(2) }}</b></p>
                            <hr>
                            <h5>Reviews</h5>
                            <div v-if="reviews.length > 0">
                                <div class="mb-2" v-for="review in reviews" :key="review.id">
                                    <strong>User {{ review.userId }}</strong> - {{ review.rating }}/5
                                    <p>{{ review.comment }}</p>
                                </div>
                            </div>
                            <p v-else>No reviews yet.</p>
                            <hr>
                            <h5>Leave a Review</h5>
                            <form id="review-form" @submit.prevent="submitReview">
                                <div class="mb-3">
                                    <label for="rating" class="form-label">Rating</label>
                                    <select class="form-select" id="rating" v-model.number="reviewRating" required>
                                        <option>5</option>
                                        <option>4</option>
                                        <option>3</option>
                                        <option>2</option>
                                        <option>1</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="comment" class="form-label">Comment</label>
                                    <textarea class="form-control" id="comment" rows="3" v-model="reviewComment"></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Submit Review</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="cart-modal" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Shopping Cart</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="cart-items">
                        <div v-if="cartItems.length > 0">
                            <div class="d-flex justify-content-between align-items-center mb-2" v-for="item in cartItems" :key="item.id">
                                <span>{{ item.product.name }}</span>
                                <span>Quantity: {{ item.quantity }}</span>
                                <span>${{ (item.product.price * item.quantity).toFixed(2) }}</span>
                            </div>
                        </div>
                        <p v-else>Your cart is empty.</p>
                    </div>
                    <p class="fw-bold">Total: $<span id="cart-total">{{ cartTotal.toFixed(2) }}</span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="checkout-button">Checkout</button>
                </div>
            </div>
        </div>
    </div>

    <div id="login-modal" class="modal fade" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="login-form" @submit.prevent="handleLogin">
                        <div class="mb-3">
                            <label for="login-username" class="form-label">Username</label>
                            <input type="text" class="form-control" id="login-username" v-model="loginUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="login-password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="login-password" v-model="loginPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Login</button>
                        <p class="mt-3">Don't have an account? <a href="#" id="show-register" @click.prevent="showRegisterForm">Register</a></p>
                    </form>
                    <form id="register-form" @submit.prevent="handleRegister" style="display: none;">
                        <div class="mb-3">
                            <label for="register-username" class="form-label">Username</label>
                            <input type="text" class="form-control" id="register-username" v-model="registerUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="register-password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="register-password" v-model="registerPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Register</button>
                        <p class="mt-3">Already have an account? <a href="#" id="show-login" @click.prevent="showLoginForm">Login</a></p>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="orders-modal" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">My Orders</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="order-list">
                        <!-- Order history will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center p-3 mt-4">
        <p>&copy; 2025 Go-Commerce</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="app.js"></script>
</body>
</html>
